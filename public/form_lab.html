<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lab</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- App styles / libs -->
    <link rel="stylesheet" href="css/styles.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .container {
            flex: 1;
            background-color: #f3f4f6;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, .08);
            max-width: 1000px;
            margin: 48px auto
        }

        .form-group {
            margin-bottom: 16px
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 6px
        }

        .form-row {
            display: flex;
            gap: 16px;
            flex-wrap: wrap
        }

        .form-row .form-group {
            flex: 1 1 48%
        }

        .note {
            font-size: .85rem;
            color: #6b7280
        }

        .card-like {
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px
        }

        .btn-pill {
            border-radius: 999px
        }

        .input-readonly {
            background: #f9fafb
        }

        @media (max-width:480px) {
            .form-row .form-group {
                flex-basis: 100%
            }
        }

        /* โมดัลอยู่บนสุด และคลิกได้แน่ */
        .modal {
            z-index: 1065 !important
        }

        .modal-backdrop.show {
            z-index: 1060 !important
        }

        #saveConfirmModal .btn {
            pointer-events: auto !important
        }
    </style>
</head>

<body>
    <!-- ===== Header แบบเดิม ===== -->
    <header class="header">
        <div class="logo-container">
            <img src="/images/logo.png" alt="Logo">
            <img src="/images/Logo_su.png" alt="Logo_su" style="width: 60px; height: auto;">
            <div class="header-text">
                <div class="header-title">Web Application Enhancing Cardiovascular Disease Risk Assessment</div>
                <div class="header-subtitle">by Phramongkutklao College of Medicine &amp; Silpakorn University</div>
            </div>
        </div>
        <div class="right-buttons">
            <div class="dropdown">
                <div class="dropdown-content">
                    <a href="/">หน้าหลัก</a>
                    <a href="/about">About Me</a>
                </div>
                <button>&#8942;</button>
            </div>
            <a href="/login.html" class="login-button" id="loginbutton">Sign In</a>
        </div>
    </header>

    <div class="container">
        <form id="theForm" novalidate>
            <div class="mb-3">
                <h2 class="fw-bold mb-1" style="font-size:26px;">
                    การประเมินความเสี่ยงโรคหัวใจและหลอดเลือดแบบใช้ผลการตรวจเลือด</h2>
                <div class="text-muted">Laboratory-based predicted 10-year CVD Risk (The 2019 WHO CVD Risk Charts)</div>
            </div>

            <!-- Form completeness -->
            <div class="mb-3" id="form-completeness">
                <div class="d-flex justify-content-between align-items-center mb-1">
                    <span class="small text-muted">ความคืบหน้าการกรอกฟอร์ม</span>
                    <span class="small" id="progressLabel">0%</span>
                </div>
                <div class="progress" style="height:10px;">
                    <div id="formProgress" class="progress-bar bg-danger" role="progressbar" style="width:0%;"
                        aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"></div>
                </div>
            </div>

            <div class="card-like mb-3">
                <div class="form-row">
                    <div class="form-group">
                        <label for="name">ชื่อ (Name)</label>
                        <input type="text" id="name" class="form-control"
                            placeholder="ไม่จำเป็นต้องกรอก (no required)" />
                    </div>
                    <div class="form-group">
                        <label for="lastname">นามสกุล (Surname)</label>
                        <input type="text" id="lastname" class="form-control"
                            placeholder="ไม่จำเป็นต้องกรอก (no required)" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="cvsex">เพศ (Sex) <span class="text-danger">*</span></label>
                        <select id="cvsex" class="form-select" required>
                            <option value="">ระบุเพศ (Select Sex)</option>
                            <option value="1">ชาย (Male)</option>
                            <option value="0">หญิง (Female)</option>
                        </select>
                        <div class="invalid-feedback">โปรดระบุเพศ</div>
                    </div>
                    <div class="form-group">
                        <label for="age">อายุ (Age) <span class="text-danger">*</span></label>
                        <input type="number" id="age" min="39" class="form-control" placeholder="ปี" required />
                        <div class="invalid-feedback">อายุต้องไม่น้อยกว่า 39 ปี</div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="cvsmk">ปัจจุบันสูบบุหรี่ (Current smoking) <span
                                class="text-danger">*</span></label>
                        <select id="cvsmk" class="form-select" required>
                            <option value="">โปรดระบุ (Select Status)</option>
                            <option value="1">สูบ (Yes)</option>
                            <option value="0">ไม่สูบ (No)</option>
                        </select>
                        <div class="invalid-feedback">โปรดระบุสถานะการสูบบุหรี่</div>
                    </div>
                    <div class="form-group">
                        <label for="cvdm">โรคเบาหวาน (Diabetes) <span class="text-danger">*</span></label>
                        <select id="cvdm" class="form-select" required>
                            <option value="">โปรดระบุ (Select Status)</option>
                            <option value="1">เป็น (Yes)</option>
                            <option value="0">ไม่เป็น (No)</option>
                        </select>
                        <div class="invalid-feedback">โปรดระบุสถานะเบาหวาน</div>
                    </div>
                </div>

                <div class="form-row align-items-end">
                    <div class="form-group">
                        <label for="sbp1">ความดันค่าบน ครั้งที่ 1 (1st SBP) <span class="text-danger">*</span></label>
                        <div class="input-group">
                            <input type="number" id="sbp1" class="form-control" placeholder="เช่น 140" required />
                            <span class="input-group-text">mmHg</span>
                        </div>
                        <div class="invalid-feedback">กรอก SBP ครั้งที่ 1</div>
                    </div>
                    <div class="form-group">
                        <label for="sbp2">ความดันค่าบน ครั้งที่ 2 (2nd SBP) <span class="text-danger">*</span></label>
                        <div class="input-group">
                            <input type="number" id="sbp2" class="form-control" placeholder="เช่น 138" required />
                            <span class="input-group-text">mmHg</span>
                        </div>
                        <div class="invalid-feedback">กรอก SBP ครั้งที่ 2</div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="tc">คลอเลสเตอรอลรวม (Total cholesterol) <span class="text-danger">*</span></label>
                        <div class="input-group">
                            <input type="number" id="tc" min="1" class="form-control" placeholder="เช่น 190" required />
                            <span class="input-group-text">mg/dL</span>
                        </div>
                        <div class="invalid-feedback">กรอกค่า Total cholesterol</div>
                    </div>
                    <div class="form-group">
                        <label for="sbpAvg">ค่าเฉลี่ย SBP (คำนวณอัตโนมัติ)</label>
                        <input type="text" id="sbpAvg" class="form-control input-readonly" value="-" readonly />
                        <div class="note">ระบบจะคำนวณเมื่อกรอกครบทั้งสองค่า</div>
                    </div>
                </div>
            </div>

            <div class="card-like mb-3">
                <!-- สวิตช์โหมดจังหวัด/ประเทศ -->
                <div class="form-check form-switch mb-2">
                    <input class="form-check-input" type="checkbox" id="modeSwitcher" checked />
                    <label class="form-check-label" for="modeSwitcher">โหมดต่างประเทศ — ใช้ Country แทน Province</label>
                    <div class="note">ปิดสวิตช์หากต้องการใช้รายชื่อจังหวัดของไทย</div>
                </div>

                <!-- จังหวัด (ไทย) -->
                <div class="form-group" id="province-group" style="display:none;">
                    <label for="provinceTH">จังหวัดที่อยู่ (Province) <span class="text-danger">*</span></label>
                    <select id="provinceTH" class="form-select">
                        <option value="">-- กรุณาเลือกจังหวัด --</option>
                    </select>
                    <div class="invalid-feedback">โปรดเลือกจังหวัด</div>
                </div>

                <!-- ประเทศ (ต่างประเทศ) -->
                <div class="form-group" id="country-group">
                    <label for="country">Country <span class="text-danger">*</span></label>
                    <select id="country" class="form-select">
                        <option value="">-- กรุณาเลือกประเทศ --</option>
                    </select>
                    <div class="invalid-feedback">โปรดเลือกประเทศ</div>
                </div>

                <!-- field เดียวที่ส่งเสมอ -->
                <input type="hidden" id="province" name="province" value="" />
                <div class="note mt-1">จะบันทึกลงฟิลด์ <b>province</b>: <span id="regionPreviewVal">-</span></div>
            </div>

            <!-- ปุ่มหลัก -->
            <div class="d-flex gap-2 justify-content-end">
                <button type="button" class="btn btn-outline-secondary btn-pill" id="btnClear">ล้างฟอร์ม</button>
                <button type="button" class="btn btn-success btn-pill" id="btnShowRisk"
                    onclick="generateStataCode()">แสดงผลการประเมินความเสี่ยง</button>
            </div>

            <div class="text-start text-muted my-3" style="clear:both;">
                จำนวนผู้เข้าใช้งาน: <span id="visit-counter">กำลังโหลด...</span> ครั้ง
            </div>

            <div id="result" class="mt-3" aria-live="polite"></div>

            <script>
                // นับผู้เข้าใช้งาน
                fetch('/visit?page=form_lab')
                    .then(res => res.json())
                    .then(data => { document.getElementById('visit-counter').textContent = data.totalVisits.toLocaleString(); })
                    .catch(() => { document.getElementById('visit-counter').textContent = 'เกิดข้อผิดพลาด'; });
            </script>
        </form>
    </div>

    <!-- Modal: ยืนยันก่อนแสดงผล -->
    <div class="modal fade" id="saveConfirmModal" tabindex="-1" aria-labelledby="saveConfirmLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="saveConfirmLabel">บันทึกข้อมูลก่อนหรือไม่?</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ปิด"></button>
                </div>
                <div class="modal-body">
                    ต้องการบันทึกข้อมูลที่กรอกไว้ลงระบบก่อนแสดงผลการประเมินหรือไม่
                    <div id="saveErrorBox" class="alert alert-danger d-none mt-3">
                        <span id="saveErrorText"></span>
                    </div>
                </div>
                <div class="modal-footer flex-nowrap gap-2">
                    <button id="skipSave" type="button" class="btn btn-outline-secondary text-nowrap"
                        data-bs-dismiss="modal">ไม่บันทึก แสดงผลเลย</button>
                    <button id="confirmSaveFirst" type="button" class="btn btn-success text-nowrap">
                        <span class="spinner-border spinner-border-sm me-2 d-none" id="saveSpinner" role="status"
                            aria-hidden="true"></span>
                        บันทึกก่อน แล้วแสดงผล
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: สถานะ (โหลด/สำเร็จ/กำลังประมวลผล) -->
    <div class="modal fade" id="progressModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static"
        data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-4">
                <div id="progressSpinner" class="mb-3">
                    <div class="spinner-border" role="status" aria-hidden="true"></div>
                </div>
                <h5 id="progressTitle" class="mb-1">กำลังดำเนินการ...</h5>
                <div id="progressText" class="text-muted">โปรดรอสักครู่</div>
            </div>
        </div>
    </div>

    <!-- สคริปต์หลักของคุณ (ต้องประกาศ window.generateStataCode) -->
    <script src="js/script_lab_n.js"></script>

    <script>
        // ====== คำนวณ SBP เฉลี่ยโชว์ ======
        (function () {
            const s1 = document.getElementById('sbp1'), s2 = document.getElementById('sbp2'), avg = document.getElementById('sbpAvg');
            function up() { const a = Number(s1.value), b = Number(s2.value); avg.value = (isFinite(a) && isFinite(b)) ? (((a + b) / 2).toFixed(1) + ' mmHg') : '-'; }
            s1.addEventListener('input', up); s2.addEventListener('input', up); up();
        })();

        // ====== สวิตช์จังหวัด/ประเทศ → รวมค่าเข้า hidden ======
        (function () {
            const sw = document.getElementById('modeSwitcher'), pWrap = document.getElementById('province-group'), cWrap = document.getElementById('country-group');
            const pTH = document.getElementById('provinceTH'), ctry = document.getElementById('country'), hidden = document.getElementById('province'), preview = document.getElementById('regionPreviewVal');

            function apply() { const useC = sw.checked; cWrap.style.display = useC ? '' : 'none'; pWrap.style.display = useC ? 'none' : ''; ctry.required = useC; pTH.required = !useC; sync(); }
            function sync() { hidden.value = sw.checked ? (ctry.value || '') : (pTH.value || ''); preview.textContent = hidden.value || '-'; }

            sw.addEventListener('change', apply); ctry.addEventListener('change', sync); pTH.addEventListener('change', sync); apply();

            // โหลดจังหวัด
            fetch('/api/provinces').then(r => r.json()).then(list => {
                pTH.innerHTML = '<option value="">-- กรุณาเลือกจังหวัด --</option>';
                list.forEach(p => { const o = document.createElement('option'); o.value = p.ProvinceName; o.textContent = p.ProvinceName; pTH.appendChild(o); });
            }).catch(() => { pTH.innerHTML = '<option value="">โหลดจังหวัดไม่สำเร็จ</option>'; });

            // โหลดประเทศ
            fetch('/api/country').then(r => r.json()).then(list => {
                ctry.innerHTML = '<option value="">-- กรุณาเลือกประเทศ --</option>';
                list.forEach(c => { const o = document.createElement('option'); o.value = c.countryID; o.textContent = `${c.countryName} (${c.alpha2_code})`; ctry.appendChild(o); });
            }).catch(() => { ctry.innerHTML = '<option value="">โหลดประเทศไม่สำเร็จ</option>'; });

            // === ฟังก์ชันล้างฟอร์ม (แก้ให้ทำงานแน่นอน) ===
            window.__clearForm = function () {
                // รีเซ็ตฟอร์มมาตรฐาน
                document.getElementById('theForm').reset();

                // คืนสวิตช์เป็นโหมดประเทศ (ค่าเริ่มต้น)
                sw.checked = true;
                cWrap.style.display = '';
                pWrap.style.display = 'none';

                // เคลียร์ค่าช่องเลือกและ hidden
                ctry.value = '';
                pTH.value = '';
                hidden.value = '';
                preview.textContent = '-';

                // เคลียร์ค่าเฉลี่ย SBP และสถานะ validate
                document.getElementById('sbpAvg').value = '-';
                const form = document.getElementById('theForm');
                form.classList.remove('was-validated');
                form.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));
            };
        })();

        // ผูกปุ่มล้างฟอร์ม
        document.getElementById('btnClear').addEventListener('click', function () {
            if (window.__clearForm) window.__clearForm();
        });

        // ====== รวมข้อมูล + บันทึก ======
        function collectFormDataOrThrow() {
            const s1 = Number($('#sbp1').val()), s2 = Number($('#sbp2').val());
            if (!Number.isFinite(s1) || !Number.isFinite(s2)) throw new Error('โปรดกรอกค่าความดันโลหิตทั้งสองครั้ง');
            const sbpAvg = Math.round(((s1 + s2) / 2) * 10) / 10;
            const region = $('#province').val();
            if (!region) throw new Error('โปรดระบุ จังหวัด (โหมดไทย) หรือ ประเทศ (โหมดต่างประเทศ)');
            return {
                sex: $('#cvsex').val(), age: $('#age').val(), smoking_status: $('#cvsmk').val(), diabetes_status: $('#cvdm').val(),
                province: region, sbp1: s1, sbp2: s2, sbptotal: sbpAvg, total_cholesterol: $('#tc').val()
            };
        }

        function saveFormDataAsync() {
            return new Promise((resolve, reject) => {
                let data; try { data = collectFormDataOrThrow(); } catch (e) { return reject(e); }
                $.ajax({
                    url: '/api/save-form', method: 'POST', data,
                    success: res => resolve(res),
                    error: () => reject(new Error('บันทึกข้อมูลไม่สำเร็จ กรุณาลองอีกครั้ง'))
                });
            });
        }

        // ====== Hook generateStataCode ให้เปิด modal ถามก่อน ======
        (function hookOriginalGenerate() {
            const TARGET_FN_NAME = 'generateStataCode';
            const SAVE_MODAL = new bootstrap.Modal(document.getElementById('saveConfirmModal'));
            const PROG_MODAL = new bootstrap.Modal(document.getElementById('progressModal'), { backdrop: 'static', keyboard: false });
            const progressTitle = document.getElementById('progressTitle');
            const progressText = document.getElementById('progressText');
            const progressSpinner = document.getElementById('progressSpinner');
            const $errBox = $('#saveErrorBox'), $errText = $('#saveErrorText'), $saveBtn = $('#confirmSaveFirst'), $skipBtn = $('#skipSave'), $saveSpin = $('#saveSpinner');
            const delay = ms => new Promise(r => setTimeout(r, ms));

            function showConfirm() {
                $errBox.addClass('d-none'); $errText.text('');
                $saveSpin.addClass('d-none'); $saveBtn.prop('disabled', false); $skipBtn.prop('disabled', false);
                SAVE_MODAL.show();
            }
            function showProgress(title, text, spinning = true) {
                progressTitle.textContent = title; progressText.textContent = text || 'โปรดรอสักครู่';
                spinning ? progressSpinner.classList.remove('d-none') : progressSpinner.classList.add('d-none');
                PROG_MODAL.show();
            }

            let tries = 0;
            (function waitForOriginal() {
                if (typeof window[TARGET_FN_NAME] === 'function' && !window.__originalGenerate) {
                    window.__originalGenerate = window[TARGET_FN_NAME].bind(window);

                    window[TARGET_FN_NAME] = function () {
                        const form = document.getElementById('theForm');
                        if (!form.checkValidity()) { form.classList.add('was-validated'); form.querySelector(':invalid')?.focus(); return; }
                        showConfirm();
                    };

                    // บันทึกก่อน → โหลด 3 วิ → เรียกฟังก์ชันเดิม
                    $saveBtn.on('click', async function () {
                        $errBox.addClass('d-none'); $errText.text('');
                        $saveSpin.removeClass('d-none'); $saveBtn.prop('disabled', true); $skipBtn.prop('disabled', true);

                        let p;
                        try { p = saveFormDataAsync(); }
                        catch (e) { $saveSpin.addClass('d-none'); $saveBtn.prop('disabled', false); $skipBtn.prop('disabled', false); $errText.text(e.message || 'บันทึกข้อมูลไม่สำเร็จ'); $errBox.removeClass('d-none'); return; }

                        SAVE_MODAL.hide();
                        showProgress('กำลังบันทึกข้อมูล...', 'โปรดรอประมาณ 3 วินาที', true);

                        try {
                            await Promise.all([p, delay(3000)]);
                            progressSpinner.classList.add('d-none');
                            progressTitle.textContent = 'บันทึกสำเร็จ';
                            progressText.textContent = '';
                            await delay(1000);
                            PROG_MODAL.hide();
                            window.__originalGenerate();
                        } catch (e) {
                            PROG_MODAL.hide();
                            $errText.text(e && e.message ? e.message : 'บันทึกข้อมูลไม่สำเร็จ'); $errBox.removeClass('d-none'); SAVE_MODAL.show();
                        } finally {
                            $saveSpin.addClass('d-none'); $saveBtn.prop('disabled', false); $skipBtn.prop('disabled', false);
                        }
                    });

                    // ไม่บันทึก → โหลด 3 วิ → เรียกฟังก์ชันเดิม
                    $skipBtn.on('click', async function () {
                        SAVE_MODAL.hide();
                        showProgress('กำลังประมวลผล...', 'โปรดรอประมาณ 3 วินาที', true);
                        await delay(3000);
                        PROG_MODAL.hide();
                        window.__originalGenerate();
                    });

                } else if (tries < 50) {
                    tries++; setTimeout(waitForOriginal, 100);
                } else {
                    console.warn('ไม่พบ window.generateStataCode — โปรดประกาศใน js/script_lab_n.js');
                }
            })();
        })();

        // โฟกัสปุ่มในโมดัลยืนยันเมื่อเปิด
        document.addEventListener('shown.bs.modal', function (e) {
            if (e.target.id === 'saveConfirmModal') {
                document.getElementById('confirmSaveFirst')?.focus();
            }
        });
    </script>
    <script>
        // ===== ตั้งค่าฟิลด์จำเป็นที่ต้องกรอกให้ครบ =====
        const REQUIRED_IDS = ['cvsex', 'age', 'cvsmk', 'cvdm', 'sbp1', 'sbp2', 'tc', 'province']; // province คือค่ารวมจากสวิตช์ จังหวัด/ประเทศ

        // อ่านค่าแบบปลอดภัย
        function getFieldValue(id) {
            const el = document.getElementById(id);
            if (!el) return '';
            return (el.value ?? '').toString().trim();
        }

        // อัปเดตแถบความคืบหน้า
        function updateFormProgress() {
            const total = REQUIRED_IDS.length;
            let filled = 0;

            for (const id of REQUIRED_IDS) {
                const val = getFieldValue(id);
                if (val !== '') filled++;
            }

            const pct = Math.round((filled / total) * 100);
            const bar = document.getElementById('formProgress');
            const lbl = document.getElementById('progressLabel');

            if (!bar || !lbl) return;

            bar.style.width = pct + '%';
            bar.setAttribute('aria-valuenow', String(pct));
            lbl.textContent = pct + '%';

            // สีตามเปอร์เซ็นต์: <40 แดง, 40–79 เหลือง, >=80 เขียว
            bar.classList.remove('bg-danger', 'bg-warning', 'bg-success');
            if (pct < 40) bar.classList.add('bg-danger');
            else if (pct < 80) bar.classList.add('bg-warning');
            else bar.classList.add('bg-success');
        }

        // ผูกอีเวนต์กับอินพุต/เซเล็กต์ที่เกี่ยวข้อง
        function bindProgressListeners() {
            // รวมฟิลด์ที่อาจมีผลต่อค่า province ด้วย (country, provinceTH, modeSwitcher)
            const ids = [...REQUIRED_IDS, 'country', 'provinceTH', 'modeSwitcher'];
            ids.forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;
                const ev = (el.tagName === 'SELECT' || el.type === 'checkbox') ? 'change' : 'input';
                el.addEventListener(ev, updateFormProgress);
            });
        }

        // เรียกใช้เมื่อ DOM พร้อม
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => { bindProgressListeners(); updateFormProgress(); });
        } else {
            bindProgressListeners(); updateFormProgress();
        }

        // ให้ฟังก์ชันสาธารณะไว้เรียกจากสวิตช์ของคุณ (เช่น หลัง sync hidden #province แล้ว)
        window.refreshFormProgress = updateFormProgress;
    </script>


    <footer class="container my-4">
        <div class="footer-content small text-muted">
            <p>ความเสี่ยงต่อการป่วยหรือเสียชีวิตจากโรคหัวใจและหลอดเลือด เช่น
                กล้ามเนื้อหัวใจขาดเลือดและโรคเส้นเลือดสมองตีบในระยะ 10 ปีข้างหน้า
                สำหรับผู้ที่ไม่เคยมีประวัติการป่วยด้วยโรคกล้ามเนื้อหัวใจขาดเลือดและโรคเส้นเลือดสมองตีบมาก่อน
                โดยการประเมินความเสี่ยงใช้ 2019 World Health Organization cardiovascular disease risk charts สำหรับ
                Southeast Asia Countries<sup>1</sup>.</p>
            <p><sup>1</sup> WHO CVD Risk Chart Working Group (2019). World Health Organization cardiovascular disease
                charts: revised models to estimate risk in 21 global regions. The Lancet. Global health, 7(10),
                e1332–e1345.
                <a href="https://doi.org/10.1016/S2214-109X(19)30318-3"
                    target="_blank">https://doi.org/10.1016/S2214-109X(19)30318-3</a>
            </p>
        </div>
    </footer>
</body>

</html>